<div class="container">
  <div class="page-header">
    <h1 class="page-title"><%= @quiz.title %></h1>
    <div>
      <%= link_to "Modifier", edit_formateur_quiz_path(@quiz), class: "btn btn-outline" %>
      <%= link_to "Gérer les questions", formateur_quiz_questions_path(@quiz), class: "btn btn-primary" %>
    </div>
  </div>

  <div class="dashboard-grid" style="grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));">
    <div class="stat-card">
      <h3><%= @quiz.questions.count %></h3>
      <p>Questions</p>
    </div>
    
    <div class="stat-card" style="background: linear-gradient(135deg, var(--secondary-color), #059669);">
      <h3><%= @quiz.quiz_attempts.count %></h3>
      <p>Tentatives</p>
    </div>
    
    <div class="stat-card" style="background: linear-gradient(135deg, var(--warning-color), #d97706);">
      <h3><%= @quiz.quiz_attempts.completed.count %></h3>
      <p>Complétées</p>
    </div>

    <div class="stat-card" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);">
      <h3><%= @quiz.quiz_attempts.completed.average(:score)&.round(1) || 0 %>%</h3>
      <p>Score moyen</p>
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      Informations du quiz
    </div>
    <div class="card-body">
      <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem;">
        <div>
          <strong>Type :</strong>
          <% if @quiz.adaptive? %>
            <span class="badge badge-warning">Adaptatif</span>
          <% else %>
            <span class="badge badge-info">Simple</span>
          <% end %>
        </div>

        <div>
          <strong>Statut :</strong>
          <% if @quiz.active? %>
            <span class="badge badge-success">Actif</span>
          <% else %>
            <span class="badge badge-secondary">Inactif</span>
          <% end %>
        </div>

        <div>
          <strong>Durée limite :</strong>
          <%= @quiz.time_limit ? "#{@quiz.time_limit} minutes" : "Aucune" %>
        </div>

        <div>
          <strong>Score minimum :</strong>
          <%= @quiz.passing_score || "Non défini" %>%
        </div>


        <div>
          <strong>Ordre aléatoire :</strong>
          <%= @quiz.randomize_questions? ? "Oui" : "Non" %>
        </div>
      </div>

      <% if @quiz.description.present? %>
        <div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--gray-200);">
          <strong>Description :</strong>
          <p style="margin-top: 0.5rem;"><%= @quiz.description %></p>
        </div>
      <% end %>
    </div>
  </div>

  <% if @quiz.questions.any? %>
    <div class="card">
      <div class="card-header">
        Questions du quiz (<%= @quiz.questions.count %>)
      </div>
      <div class="card-body">
        <% @quiz.questions.order(:position).each_with_index do |question, index| %>
          <div style="padding: 1rem; border: 1px solid var(--gray-200); border-radius: var(--border-radius); margin-bottom: 1rem;">
            <div style="display: flex; justify-content: space-between; align-items: start;">
              <div style="flex: 1;">
                <strong>Question <%= index + 1 %> :</strong>
                <p style="margin: 0.5rem 0;"><%= question.question_text %></p>
                <div style="display: flex; gap: 1rem; margin-top: 0.5rem;">
                  <span class="badge badge-info">Niveau <%= question.difficulty_level %></span>
                  <span class="badge" style="background-color: <%= question.theme.color %>; color: white;"><%= question.theme.name %></span>
                  <% if question.multiple_correct_answers? %>
                    <span class="badge badge-warning">Réponses multiples</span>
                  <% end %>
                </div>
              </div>
              <div>
                <%= link_to "Modifier", edit_formateur_quiz_question_path(@quiz, question), class: "btn btn-sm btn-outline" %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  <% end %>
</div>
